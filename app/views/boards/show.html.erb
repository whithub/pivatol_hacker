<div class="container">
  <div class="col-md-12 header">
    <h1 class="col-md-11 text-muted"><%= @board.title %></h1>

    <h3><a class="col-md-1 btn btn-sm home-page-button" href="/boards" role="button">Home Page</a></h3>
  </div>
</div>
<hr>

  <div class="row waffle-board">
    <div class="col-md-3" id="backlog">
      <h3>Backlog</h3>
      <hr>
      <ul class="sortable1">
        <% @board.tickets.backlog.each do |ticket| %>
          <div class="tickets">
            <div class="row">
              <div class="col-md-12 backlog-ticket">
                <li data-id="<%= ticket.id %>"><h4 class="ticket-name"><%= link_to ticket.name, board_ticket_path(@board, ticket) %></h4></li>
              </div>
            </div>
          </div>
        <% end %>
      </ul>

      <br>
      <br>
      <br>

      <script src="jquery.sortable.js"></script>
      <script>
        $('.sortable').sortable();
      </script>
    </div>

    <div class="col-md-3" id="current-sprint-column">
      <h3>Current Sprint</h3>
      <hr>
      <ul class="sortable2">
        <% @board.tickets.current_sprint.each do |ticket| %>
          <div class="tickets">
            <div class="row">
              <div class="col-md-12 sprint-ticket">
                <li data-id="<%= ticket.id %>"><h4 class="ticket-name"><%= link_to ticket.name, board_ticket_path(@board, ticket) %></h4></li>
              </div>
            </div>
          </div>
        <% end %>
      </ul>
      <script src="jquery.sortable.js"></script>
      <script>
        $('.sortable').sortable();
      </script>
    </div>


    <div class="col-md-3" id="in_progress">
      <h3>In Progress</h3>
      <hr>
      <ul class="sortable3">
        <% @board.tickets.in_progress.each do |ticket| %>
          <div class="tickets">
            <div class="row">
              <div class="col-md-12 progress-ticket">
                <li data-id="<%= ticket.id %>"><h4 class="ticket-name"><%= link_to ticket.name, board_ticket_path(@board, ticket) %></h4></li>
              </div>
            </div>
          </div>
        <% end %>
      </ul>
      <script src="jquery.sortable.js"></script>
      <script>
        $('.sortable').sortable();
      </script>
    </div>

    <div class="col-md-3" id="done">
      <h3>Done</h3>
      <hr>
      <ul class="sortable4">
        <% @board.tickets.done.each do |ticket| %>
          <div class="tickets">
            <div class="row">
              <div class="col-md-12 done-ticket">
                <li data-id="<%= ticket.id %>"><h4 class="ticket-name"><%= link_to ticket.name, board_ticket_path(@board, ticket) %></h4></li>
              </div>
            </div>
          </div>
        <% end %>
      </ul>
      <script src="jquery.sortable.js"></script>
      <script>
//          $('.sortable1').sortable();
        $('.sortable1, .sortable2, .sortable3, .sortable4').sortable({
          connectWith: '.connected'
        }).bind('sortupdate', function(e, ui) {
          console.log('updated');

          $.ajax({
            type: "GET",
            url: '/tasks/sort',
            data: { order: updated_order }
          });
          //ui.item contains the current dragged element.
          //Triggered when the user stopped sorting and the DOM position has changed.
        });;
      </script>
    </div>
  </div>

  <br>
  <br>

  <div class="row">
    <div class="jumbotron" id="new-ticket-form">
      <%= render partial: 'ticket_form' %>
    </div>
  </div>

 <hr>

<footer class="footer">
  <p>Â© whithub 2015</p>
</footer>
